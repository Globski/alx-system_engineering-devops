#!/usr/bin/env bash
# Fixes a web server to run Nginx as the nginx user listening on port 8080.
id -u nginx &>/dev/null || useradd --no-create-home --shell /bin/false nginx
sed -i 's/user www-data;/user nginx;/; s/listen 80;/listen 8080;/; s/listen \[::\]:80;/listen \[::\]:8080;/' /etc/nginx/nginx.conf /etc/nginx/sites-available/default
chmod 644 /etc/nginx/nginx.conf
pkill apache2
sudo -u nginx service nginx start
